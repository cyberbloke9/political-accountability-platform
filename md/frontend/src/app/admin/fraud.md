# Admin Fraud Detection Page (admin/fraud/page.tsx)

## Overview

**File Path:** `frontend/src/app/admin/fraud/page.tsx`
**URL:** `/admin/fraud`
**Type:** Client Component (`'use client'`)

## Purpose

The Admin Fraud Detection Page provides tools for reviewing and managing fraud flags generated by the automated fraud detection system. Admins can review flags, confirm fraudulent activity, or dismiss false positives.

## Data Fetching

### Fraud Flags
- Uses `getFraudFlags()` from `@/lib/fraudDetection`
- Returns `FraudFlagWithTarget[]` including target user/verification info

### Run Detection
- Uses `runFraudDetection()` to manually trigger fraud detection
- Scans for suspicious patterns across the platform

## Components Used

### Layout Components
- `AdminGuard` - Permission check: `manage_fraud`
- `AdminLayout` - Admin page wrapper

### Custom Components
- `FraudFlagCard` - Displays individual fraud flag with actions

### UI Components
- `Button` - Action buttons
- `Card`, `CardContent`, `CardHeader`, `CardTitle`
- `Select`, `SelectContent`, `SelectItem`, `SelectTrigger`, `SelectValue`

### Icons (Lucide React)
- `AlertCircle` - Critical flags indicator
- `Loader2` - Loading spinner
- `Play` - Run detection button
- `RefreshCw` - Refresh button

### Hooks
- `useToast()` - Toast notifications

## State Management

```typescript
const [flags, setFlags] = useState<FraudFlagWithTarget[]>([])
const [filteredFlags, setFilteredFlags] = useState<FraudFlagWithTarget[]>([])
const [loading, setLoading] = useState(true)
const [actionLoading, setActionLoading] = useState(false)
const [detectLoading, setDetectLoading] = useState(false)
const [statusFilter, setStatusFilter] = useState<string>('all')
const [severityFilter, setSeverityFilter] = useState<string>('all')
const [typeFilter, setTypeFilter] = useState<string>('all')
const [stats, setStats] = useState({...})
```

## Stats Cards

| Stat | Color | Description |
|------|-------|-------------|
| Total Flags | - | All fraud flags |
| Pending Review | Yellow | Awaiting admin review |
| Confirmed | Red | Confirmed fraud cases |
| Dismissed | Green | False positives |
| Critical | Red | Critical severity flags |

## Filter Options

### Status Filter
- All Status
- Pending
- Reviewed
- Confirmed
- Dismissed

### Severity Filter
- All Severity
- Low
- Medium
- High
- Critical

### Type Filter
- All Types
- Spam
- Vote Manipulation
- Low Quality
- Duplicate
- Coordinated Voting

## User Interactions

1. **Refresh Button** - Reload fraud flags
2. **Run Detection Button** - Manually trigger fraud detection
3. **Status Filter** - Filter by review status
4. **Severity Filter** - Filter by severity level
5. **Type Filter** - Filter by fraud type
6. **Confirm Button** - Confirm fraudulent activity
7. **Dismiss Button** - Dismiss as false positive

## Confirm/Dismiss Flow

### Confirm Flag
```typescript
const handleConfirm = async (flagId: string, notes?: string) => {
  const { success, error } = await reviewFraudFlag(flagId, 'confirmed', notes)
  // Toast notification, refresh list
}
```

### Dismiss Flag
```typescript
const handleDismiss = async (flagId: string, notes?: string) => {
  const { success, error } = await reviewFraudFlag(flagId, 'dismissed', notes)
  // Toast notification, refresh list
}
```

## Run Detection Flow

1. Admin clicks "Run Detection"
2. `runFraudDetection()` scans for patterns
3. New flags are created for suspicious activity
4. List is refreshed to show new flags

## Authentication Requirements

- **Required:** Yes (Admin)
- Permission: `manage_fraud`

## Fraud Flag Card Features

Each card shows:
- Flag type and severity
- Target user/verification info
- Detection reason
- Timestamp
- Confirm/Dismiss buttons
- Notes input for review

## Loading States

- Centered spinner during data fetch
- Button loading states during detection run
- Disabled state during actions

## Empty States

- "No fraud flags found matching your filters" message

## Grid Layout

- Responsive 5-column stats grid
- Stacked flag cards with full width
